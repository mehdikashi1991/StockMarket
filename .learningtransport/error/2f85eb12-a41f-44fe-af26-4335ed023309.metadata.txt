{
  "NServiceBus.MessageId": "f322f02f-1f50-465d-86f8-b016006a798e",
  "NServiceBus.MessageIntent": "Send",
  "NServiceBus.ConversationId": "0223b9ce-7b3b-46d6-8442-b016006a7993",
  "NServiceBus.CorrelationId": "f322f02f-1f50-465d-86f8-b016006a798e",
  "NServiceBus.ReplyToAddress": "ApiGateway",
  "NServiceBus.OriginatingMachine": "DESKTOP-IVIJ3AV",
  "NServiceBus.OriginatingEndpoint": "ApiGateway",
  "$.diagnostics.originating.hostid": "208cbe99ccf74e302d36f62b81ec22fd",
  "NServiceBus.ContentType": "text\/xml",
  "NServiceBus.EnclosedMessageTypes": "Messages.AddOrderCommandMessage, Messages, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null",
  "NServiceBus.Version": "8.0.3",
  "NServiceBus.TimeSent": "2023-06-03 06:27:39:834552 Z",
  "traceparent": "00-207160aed0128424058afa9452b74c45-b999c9c4df580e49-00",
  "NServiceBus.ProcessingMachine": "DESKTOP-IVIJ3AV",
  "NServiceBus.Retries.Timestamp": "2023-06-03 06:53:13:562620 Z",
  "NServiceBus.DeliverAt": "2023-06-03 06:52:49:970998 Z",
  "NServiceBus.ProcessingEndpoint": "StockMarketService",
  "$.diagnostics.hostid": "69a8055815814bb8e6397c0546e82942",
  "$.diagnostics.hostdisplayname": "DESKTOP-IVIJ3AV",
  "NServiceBus.FailedQ": "StockMarketService",
  "NServiceBus.ExceptionInfo.ExceptionType": "System.InvalidOperationException",
  "NServiceBus.ExceptionInfo.HelpLink": null,
  "NServiceBus.ExceptionInfo.Message": "A root ambient transaction was completed before the nested transaction. The nested transactions should be completed first.",
  "NServiceBus.ExceptionInfo.Source": "Microsoft.EntityFrameworkCore.Relational",
  "NServiceBus.ExceptionInfo.StackTrace": "System.InvalidOperationException: A root ambient transaction was completed before the nested transaction. The nested transactions should be completed first.\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.HandleTransactionCompleted(Object sender, TransactionEventArgs e)\r\n   at System.Transactions.TransactionStateEnded.AddOutcomeRegistrant(InternalTransaction tx, TransactionCompletedEventHandler transactionCompletedDelegate)\r\n   at System.Transactions.Transaction.add_TransactionCompleted(TransactionCompletedEventHandler value)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.HandleAmbientTransactions()\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)\r\n   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)\r\n   at Infrastructure.UnitOfWork.SaveChange() in C:\\StockMarketResearch\\StockMarket\\Repository\\UnitOfWork.cs:line 33\r\n   at Application.OrderService.OrderCommandHandlers.TransactionalCommandHandler`1.Handle(T1 command) in C:\\StockMarketResearch\\StockMarket\\Application\\OrderService\\OrderCommandHandlers\\TransactionalCommandHandler.cs:line 32\r\n   at FacadeProvider.OrderFacadeProviders.OrderCommandFacade.ProcessOrder(AddOrderCommand orderCommand) in C:\\StockMarketResearch\\StockMarket\\FacadeProvider\\OrderFacadeProviders\\OrderCommandFacade.cs:line 50\r\n   at MessageHandlers.OrderCommandsHandler.Handle(AddOrderCommandMessage message, IMessageHandlerContext context) in C:\\StockMarketResearch\\StockMarket\\MessageHandlers\\OrderCommandsHandler.cs:line 47\r\n   at NServiceBus.InvokeHandlerTerminator.Terminate(IInvokeHandlerContext context) in \/_\/src\/NServiceBus.Core\/Pipeline\/Incoming\/InvokeHandlerTerminator.cs:line 33\r\n   at NServiceBus.LoadHandlersConnector.Invoke(IIncomingLogicalMessageContext context, Func`2 stage) in \/_\/src\/NServiceBus.Core\/Pipeline\/Incoming\/LoadHandlersConnector.cs:line 40\r\n   at NServiceBus.DeserializeMessageConnector.Invoke(IIncomingPhysicalMessageContext context, Func`2 stage) in \/_\/src\/NServiceBus.Core\/Pipeline\/Incoming\/DeserializeMessageConnector.cs:line 32\r\n   at NServiceBus.ProcessingStatisticsBehavior.Invoke(IIncomingPhysicalMessageContext context, Func`2 next) in \/_\/src\/NServiceBus.Core\/Performance\/Statistics\/ProcessingStatisticsBehavior.cs:line 25\r\n   at NServiceBus.TransportReceiveToPhysicalMessageConnector.Invoke(ITransportReceiveContext context, Func`2 next) in \/_\/src\/NServiceBus.Core\/Pipeline\/Incoming\/TransportReceiveToPhysicalMessageConnector.cs:line 35\r\n   at NServiceBus.RetryAcknowledgementBehavior.Invoke(ITransportReceiveContext context, Func`2 next) in \/_\/src\/NServiceBus.Core\/ServicePlatform\/Retries\/RetryAcknowledgementBehavior.cs:line 25\r\n   at NServiceBus.MainPipelineExecutor.Invoke(MessageContext messageContext, CancellationToken cancellationToken) in \/_\/src\/NServiceBus.Core\/Pipeline\/MainPipelineExecutor.cs:line 45\r\n   at NServiceBus.MainPipelineExecutor.Invoke(MessageContext messageContext, CancellationToken cancellationToken) in \/_\/src\/NServiceBus.Core\/Pipeline\/MainPipelineExecutor.cs:line 64\r\n   at NServiceBus.LearningTransportMessagePump.ProcessFile(ILearningTransportTransaction transaction, String messageId, CancellationToken messageProcessingCancellationToken) in \/_\/src\/NServiceBus.Core\/Transports\/Learning\/LearningTransportMessagePump.cs:line 340",
  "NServiceBus.TimeOfFailure": "2023-06-03 06:53:45:807306 Z",
  "NServiceBus.ExceptionInfo.Data.Message type": "Messages.AddOrderCommandMessage",
  "NServiceBus.ExceptionInfo.Data.Handler type": "MessageHandlers.OrderCommandsHandler",
  "NServiceBus.ExceptionInfo.Data.Handler start time": "2023-06-03 06:53:45:647420 Z",
  "NServiceBus.ExceptionInfo.Data.Handler failure time": "2023-06-03 06:53:45:804571 Z",
  "NServiceBus.ExceptionInfo.Data.Handler canceled": "False",
  "NServiceBus.ExceptionInfo.Data.Message ID": "f322f02f-1f50-465d-86f8-b016006a798e",
  "NServiceBus.ExceptionInfo.Data.Transport message ID": "21c37f7e-6ad0-4364-a539-11af6bd8eb73",
  "NServiceBus.ExceptionInfo.Data.Pipeline canceled": "False"
}